<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.3/jquery.min.js"></script>
    <script type="text/javascript" src="jquery.torrent.min.js"></script>

</head>
<body>
    <input type="file" id="myfile" multiple /> <span id="progress">0 / 0</span>
    <div id="ctn"></div>
    
    <script type="text/javascript">
        var startTime;
        $('#myfile').torrent({
            torrent:
            {
                announce:'udp://tracker.openbittorrent.com:80',
                "created by": "jQuery Torrent/0.1",
                "creation date": Math.round(+new Date()/1000), //timestamp
                encoding: 'UTF-8', //non-standard, yet clarifies if someone doubts
                info: {
                    name: 'Generated torrent'
                }
            },
            onTorrentCreated: function(e)
            {
                var creationTime = (+new Date()/1000) - startTime;
                var req = new XMLHttpRequest();
                req.open('POST','torrent.php');
                req.onreadystatechange = function()
                {
                    if(this.readyState == 4){
                        $('#ctn').html(this.responseText+'<br /> Torrent Creation took: '+creationTime+' sec');
                    }
                };
                req.send(e);

             //window.saveAs(e,'generated.torrent'); //shoulda wait for it to work
            },
            onProgressChanged: function(e){
                $('#progress').html(e.done + ' / ' + e.all);
            }
        }).change(function(){
            startTime = +new Date()/1000;
            $(this).gettorrent().beginCreateTorrent();
        });
    </script>

</body>
</html>
